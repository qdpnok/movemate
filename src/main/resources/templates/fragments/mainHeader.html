<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>main-header</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
  </head>
  <body>
    <header th:fragment="header">
      <div id="main-header">
        <a href="#">
          <img class="main_logo" th:src="@{/images/logo(1).png}" alt="movemate" th:onclick="|location.href='@{/}'|" style="cursor: pointer;"/>
        </a>
        <div class="user_hamburger">
          <div th:if="${session.loginUser == null}" class="user-bar">
            <button class="login" th:onclick="|location.href='@{/login}'|">
              로그인
            </button>
            <button class="signup" th:onclick="|location.href='@{/users/new}'|">
              회원가입
            </button>
          </div>
          <div th:if="${session.loginUser} != null" class="user-bar">
            <button class="my-page" th:onclick="|location.href='@{/users/mypage}'|">
              마이페이지
            </button>
            <button class="logout" th:onclick="|location.href='@{/logout}'|">
              로그아웃
            </button>
          </div>
          <div class="hamburger-container">
            <i class="fa-solid fa-bars hamburger"></i>
            <div class="menu">
              <a href="http://localhost:8282/addMate/solo">메이트 만들기</a>
              <a href="http://localhost:8282/mate">메이트 관리</a>
              <a href="http://localhost:8282/posts">게시판</a>
            </div>
          </div>
        </div>
      </div>
      <script>
        document.addEventListener('DOMContentLoaded', function() {
            const hamburgerContainer = document.querySelector('.hamburger-container');
            const hamburgerIcon = document.querySelector('.hamburger');
            const menu = document.querySelector('.menu');

            // 1. 햄버거 아이콘 클릭 이벤트: 메뉴를 열고 닫습니다.
            hamburgerIcon.addEventListener('click', function(event) {
                // 클릭 이벤트가 body까지 전파되어 메뉴가 즉시 닫히는 것을 방지
                event.stopPropagation();
                // 'is-open' 클래스를 토글하여 메뉴 상태를 변경
                hamburgerContainer.classList.toggle('is-open');
            });

            // 2. 메뉴 외부 클릭 이벤트: 메뉴가 열려있을 때, 외부를 클릭하면 닫습니다.
            document.addEventListener('click', function() {
                // 'is-open' 클래스를 제거 (닫기)
                hamburgerContainer.classList.remove('is-open');
            });

            // 3. 메뉴 영역 클릭 이벤트: 메뉴를 클릭했을 때 닫히지 않도록 방지
            menu.addEventListener('click', function(event) {
                // 클릭 이벤트가 body로 전파되는 것을 막아 닫히는 동작 방지
                event.stopPropagation();
            });
        });
    </script>
    </header>
  </body>
</html>
