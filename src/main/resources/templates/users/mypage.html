<!DOCTYPE html>
<html
        xmlns:th="http://www.thymeleaf.org"
        xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
        layout:decorate="~{/layout/main}"
>
<head>
    <meta charset="UTF-8" />
    <title>my page</title>
</head>
<body>
<div layout:fragment="content">
    <div id="mypage-container">
        <div id="mypage">
            <h1>마이페이지</h1>
            <div id="my-info">
                <div id="my-profile">
                    <img th:src="${userInfo.profileImageUrl} != null ? @{'/files/'+${userInfo.profileImageUrl}} : @{'/images/profile.png'}"
                         alt="프로필" style="width:120px;height:120px;object-fit:cover;border-radius:60px;">
                    <div id="profile">
                        <p>이름 : <span th:text="${userInfo.name}"></span></p>
                        <p>아이디 : <span th:text="${userInfo.userId}"></span></p>
                        <p>휴대폰번호 : <span th:text="${userInfo.phoneNo}"></span></p>
                        <p>성별 : <span th:text="${userInfo.gender}"></span></p>
                        <p>나이 : <span th:text="${userInfo.age}"></span></p>
                    </div>
                </div>
                <div id="my-button-filed">
                    <div id="my-button">
                        <button th:onclick="|location.href='@{/users/edit}'|">회원정보수정</button>
                        <button type="button" id="delete-button" class="btn-danger" >회원탈퇴</button>
                    </div>
                    <form th:action="@{/users/{no}/delete(no=${userInfo.userNo})}" method="post" id="delete-form" style="display: none;"></form>
                </div>

                <div id="my-match">
                    <h2 id="sub-title">나의 매칭 내역</h2>
                    <div id="sport-type-choice-bar">
                        <button>러닝 메이트</button>
                        <button>웨이트 메이트</button>
                    </div>
                    <div id="group-choice-bar" >
                        <button>1:1 메이트</button>
                        <button>메이트 크루</button>
                    </div>
                    <div id="my-match-box">
                        <div id="my-match-card"></div>
                    </div>
                </div>

            </div>

        </div>
    </div>
    <script>
        const deleteButton = document.getElementById('delete-button');
      const deleteForm = document.getElementById('delete-form');

      deleteButton.addEventListener('click', () => {
        // 사용자에게 최종적으로 탈퇴 여부를 확인
        if (confirm('정말로 회원탈퇴를 하시겠습니까? 모든 정보가 삭제 처리되며 복구가 불가능할 수 있습니다.')) {
            // 확인을 누르면 숨겨진 폼을 전송 (POST 요청)
            deleteForm.submit();
        }
    });
    </script>
</div>
</body>
</html>
